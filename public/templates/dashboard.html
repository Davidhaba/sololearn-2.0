<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoloLearn 2.0: Modern Mobile Version</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="../static/styles.css" />
</head>

<body>
    <div id="dashboardContainer">
        <div id="droptopMenu">
            <div id="topLeft">
                <button class="topButton" id="menuBtn" title="Menu">
                    <i class="fas fa-bars"></i>
                    <div class="hover-el"></div>
                </button>
                <p id="droptopTitle">Home</p>
            </div>
            <div id="topRight">
                <button class="topButton" id="favBtn" title="Lives">
                    <i class="fas fa-heart"></i>
                    <div id="livesCount">0</div>
                    <div class="hover-el"></div>
                </button>
                <button class="topButton extend" id="streakBtn" title="Streak">
                    <i class="fas fa-fire"></i>
                    <div id="streakCount">0</div>
                    <div class="hover-el"></div>
                </button>
                <button class="topButton" data-open-screen="notificationsScreen" id="notifBtn" title="Notifications">
                    <i class="fas fa-bell"></i>
                    <div class="text-danger" style="display: none;" id="notifCount">0</div>
                    <div class="hover-el"></div>
                </button>
            </div>
        </div>
        <div id="app">
            <div id="main" class="appScreen active">
                <h1>Learn to Code</h1>
                <p>Choose your favorite programming language and master it step by step</p>
                <p style="font-size: 14px; margin: 0; color: var(--text-secondary);">Coming soon!</p>
            </div>

            <div id="leaders" class="appScreen">
                <p>Compete with learners worldwide and climb the rankings</p>
                <div id="leaderboardContent" style="margin-top: 30px;"></div>
            </div>

            <div id="code" class="appScreen">
                <div id="codeFilters" style="display: flex; gap: 12px; margin-bottom: 24px; flex-wrap: wrap;">
                    <button class="filterBtn active" data-filter="trending">
                        <i class="fas fa-fire"></i> Popular Today
                    </button>
                    <button class="filterBtn" data-filter="myCode">
                        <i class="fas fa-code"></i> My Codes
                    </button>
                    <button class="filterBtn" data-filter="recent">
                        <i class="fas fa-clock"></i> Recent
                    </button>
                    <button class="filterBtn" data-filter="mostLiked">
                        <i class="fas fa-heart"></i> Most Liked
                    </button>
                </div>
                <div id="codeContent"></div>
                <button id="createCodeBtn" class="primary-button createCodeBtn" title="Create new code">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <div id="userProfile" class="appScreen">
                <p style="font-size: 14px; margin-top: 20px; color: var(--text-secondary);">Nothing here.</p>
            </div>

            <div id="notificationsScreen" class="appScreen"></div>

            <div id="codeEditor" class="appScreen">
                <div style="display: flex; flex-direction: column; height: 100%; gap: 16px; padding-bottom: 20px;">
                    <div style="display: flex; gap: 12px; align-items: flex-start; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <label
                                style="display: block; font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">
                                Code Title</label>
                            <input type="text" id="editorTitle" placeholder="My awesome code"
                                style="width: 100%; padding: 12px; background: rgba(99, 102, 241, 0.08); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 8px; color: var(--text-primary); font-family: inherit; font-size: 14px;">
                        </div>
                        <div style="flex: 1; min-width: 150px;">
                            <label
                                style="display: block; font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">Language</label>
                            <select id="editorLanguage"
                                style="width: 100%; padding: 12px; background: rgba(99, 102, 241, 0.08); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 8px; color: var(--text-primary); font-family: inherit; font-size: 14px;">
                                <option value="SelectLanguage" disabled selected>Select Language</option>
                                <option value="JavaScript">JavaScript</option>
                                <option value="Python">Python</option>
                                <option value="Java">Java</option>
                                <option value="C++">C++</option>
                                <option value="C#">C#</option>
                                <option value="PHP">PHP</option>
                                <option value="Ruby">Ruby</option>
                                <option value="Go">Go</option>
                                <option value="Rust">Rust</option>
                                <option value="TypeScript">TypeScript</option>
                                <option value="HTML">HTML</option>
                                <option value="CSS">CSS</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label
                            style="display: block; font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">Description</label>
                        <input type="text" id="editorDescription" placeholder="What does this code do?"
                            style="width: 100%; padding: 12px; background: rgba(99, 102, 241, 0.08); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 8px; color: var(--text-primary); font-family: inherit; font-size: 14px;">
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; min-height: 300px;">
                        <label
                            style="display: block; font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">Code</label>
                        <textarea id="editorContent" placeholder="Paste or write your code here..."
                            style="flex: 1; padding: 14px; background: rgba(99, 102, 241, 0.08); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 8px; color: var(--text-primary); font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 13px; resize: none; line-height: 1.5;"></textarea>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button id="editorPublishBtn" class="primary-button" style="flex: 1;">
                            <i class="fas fa-paper-plane"></i> Publish Code</button>
                        <button id="editorDiscardBtn" class="secondary-button"
                            style="flex: 0 1; border-color: rgba(239, 68, 68, 0.3); color: var(--danger);">
                            <i class="fas fa-times"></i> Discard</button>
                    </div>
                </div>
            </div>

            <div id="profileEditor" class="appScreen">
                <div style="display:flex;flex-direction:column;height:100%;gap:16px;padding-bottom:20px;">
                    <div>
                        <label
                            style="display:block;font-size:12px;color:var(--text-secondary);margin-bottom:6px;text-transform:uppercase;letter-spacing:0.5px;font-weight:600;">
                            Full name</label>
                        <input type="text" id="profileEditorName" placeholder="Your name"
                            style="width:100%;padding:12px;background:rgba(99,102,241,0.08);border:1px solid rgba(99,102,241,0.2);border-radius:8px;color:var(--text-primary);">
                    </div>
                    <div>
                        <label
                            style="display:block;font-size:12px;color:var(--text-secondary);margin-bottom:6px;text-transform:uppercase;letter-spacing:0.5px;font-weight:600;">
                            Photo URL (optional)</label>
                        <input type="text" id="profileEditorPhoto" placeholder="https://..."
                            style="width:100%;padding:12px;background:rgba(99,102,241,0.08);border:1px solid rgba(99,102,241,0.2);border-radius:8px;color:var(--text-primary);">
                    </div>

                    <div style="display:flex;gap:12px;margin-top:auto;">
                        <button id="profileSaveBtn" class="primary-button" style="flex:1;"><i
                                class="fas fa-cloud-arrow-up"></i> Save</button>
                        <button id="profileCancelBtn" class="secondary-button" style="flex:1;"><i
                                class="fas fa-rotate-left"></i> Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="dropdownMenu">
            <button class="downButton active" data-screen="main" data-open-screen="main" title="Home">
                <i class="fas fa-home"></i>
                <div class="text-danger">Home</div>
            </button>
            <button class="downButton" data-screen="leaders" data-open-screen="leaders" title="Leaderboard">
                <i class="fas fa-trophy"></i>
                <div class="text-danger">Leaders</div>
            </button>
            <button class="downButton" data-screen="code" data-open-screen="code" title="Code">
                <i class="fas fa-code"></i>
                <div class="text-danger">Code</div>
            </button>
            <button class="downButton" id="profileBtn" data-screen="userProfile" data-open-screen="userProfile"
                title="Profile" style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                <img id="profileImage" src="" alt="Photo"
                    style="display: none; width: 20px; height: 20px; border-radius: 50%; object-fit: cover;">
                <i class="fas fa-user" id="profileIcon" style="font-size: 20px;"></i>
                <div class="text-danger" id="profileName">
                    Profile</div>
            </button>
        </div>
    </div>

    <div id="sideMenuOverlay"></div>
    <div id="sideMenu">
        <div class="sideMenuItem"
            style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;">
            <div class="hoverAnim" id="sideMenuProfile" role="button" tabindex="0">
                <div style="width:32px;height:32px;border-radius:50%;overflow:hidden;flex:0 0 32px;">
                    <img id="sideMenuAvatar" src="" alt="avatar"
                        style="width:100%;height:100%;object-fit:cover;display:block;">
                </div>
                <div>
                    <div id="sideMenuName" style="font-weight:700">User</div>
                    <div style="font-size:12px;color:var(--text-secondary);">View profile</div>
                </div>
            </div>
            <button id="closeSideMenu" class="secondary-button" style="font-size:18px; padding: 8px 10px;">âœ•</button>
        </div>

        <nav class="sideMenuItem" id="sideMenuNav">
            <button class="menuItem hoverAnim" data-open-screen="main">Home</button>
            <button class="menuItem hoverAnim" data-open-screen="leaders">Leaderboard</button>
            <button class="menuItem hoverAnim" data-open-screen="code">Code</button>
            <button class="menuItem hoverAnim" data-open-screen="notificationsScreen">Notifications</button>
        </nav>

        <div class="sideMenuItem" id="toggleDebug" style="padding: 15px 10px; font-size: 14px;">
            <input type="checkbox" onchange="toggleDebug(this.checked)" id="debugToggle" style="float:right;">
            <label for="debugToggle">Debug Mode</label>
        </div>

        <div>
            <div class="sideMenuItem">
                <button id="menuLogoutBtn" class="primary-button red-back-btn" style="width:100%;">Log out</button>
            </div>
        </div>
    </div>

    <div id="logoutModal"
        style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:999;align-items:center;justify-content:center;">
    </div>

    <div id="consoleModal"
        style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:1200;align-items:center;justify-content:center;padding:18px;">
        <div
            style="background:linear-gradient(180deg,#0b1220,#0f1724);padding:18px;border-radius:12px;width:100%;max-width:880px;max-height:80vh;overflow:auto;border:1px solid rgba(255,255,255,0.06);">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:8px;">
                <h3 style="margin:0;color:var(--text-primary);font-size:16px;">Console</h3>
                <div style="display:flex;gap:8px;align-items:center;">
                    <button id="clearConsoleBtn" class="secondary-button"
                        style="padding:6px 10px;font-size:13px;">Clear</button>
                    <button id="closeConsoleBtn" class="primary-button"
                        style="padding:6px 10px;font-size:13px;">Close</button>
                </div>
            </div>
            <div id="consoleMessages"
                style="background:rgba(255,255,255,0.02);border-radius:8px;padding:12px;font-family:monospace;font-size:13px;color:var(--text-primary);overflow:auto;max-height:62vh;">
                <div style="color:var(--text-secondary);">No messages yet.</div>
            </div>
        </div>
    </div>

    <script src="../static/authService.js"></script>
    <script src="../static/router.js"></script>
    <script>
        async function init() {
            if (typeof AuthService === 'undefined' || typeof Router === 'undefined') {
                console.error('Services not loaded, try refreshing the page.');
                return;
            }
            const s = document.createElement('script');
            s.src = '../static/index.js';
            document.body.appendChild(s);
        };
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

    </script>
    <script>
        function handleLogout() {
            const modal = document.getElementById('logoutModal');
            modal.innerHTML = `
                <div style="background:linear-gradient(180deg,#0b1220,#0f1724);padding:32px;border-radius:16px;text-align:center;max-width:320px;box-shadow:0 20px 60px rgba(0,0,0,0.8);border:1px solid rgba(255,255,255,0.08);">
                    <h3 style="color:var(--text-primary);margin:0 0 8px 0;font-size:20px;">Log out?</h3>
                    <p style="color:var(--text-secondary);margin:0 0 24px 0;font-size:14px;line-height:1.5;">
                        Are you sure you want to log out?</p>
                    <div style="display:flex;gap:10px;">
                        <button onclick="cancelLogout()" class="secondary-button"
                            style="flex:1;border-color:rgba(99,102,241,0.3);">
                            Cancel
                        </button>
                        <button onclick="confirmLogout()" class="primary-button red-back-btn"
                            style="flex:1;box-shadow:0 4px 15px rgba(231,76,60,0.3);">
                            Yes
                        </button>
                    </div>
                </div>
            `;
            modal.style.display = 'flex';
            document.querySelector('#logoutModal button').focus();
        }

        function confirmLogout() {
            document.querySelector('#logoutModal').innerHTML = `<div style="background:linear-gradient(180deg,#0b1220,#0f1724);padding:14px;border-radius:16px;text-align:center;max-width:320px;box-shadow:0 20px 60px rgba(0,0,0,0.8);border:1px solid rgba(255,255,255,0.08);">
                <div onClick="cancelLogout()" style="cursor:pointer; font-size:14px; color: white; float: right; line-height: 1;">X</div><div style="font-size:48px; margin: 16px;">ðŸ‘‹</div>
            </div>`;
            AuthService.logout();
            Router.redirectTo(Router.routers.authLogin);
        }

        function cancelLogout() {
            document.getElementById('logoutModal').style.display = 'none';
        }

        function toggleDebug(isChecked = false) {
            if (isChecked) {
                enableDebug();
            } else {
                disableDebug();
            }
        }

        function enableDebug() {
            const conBtn = document.createElement('button');
            conBtn.className = 'topButton';
            conBtn.id = 'consoleBtn';
            conBtn.title = 'Console';
            conBtn.innerHTML = `<i class="fas fa-circle-exclamation"></i><div class="text-danger" id="errorsCount">0</div>`;
            conBtn.onclick = () => {
                openConsoleModal();
            };
            conBtn.querySelector('i').style.color = '#ef4444';
            document.querySelector('#droptopMenu > #topRight').prepend(conBtn);
            updateConsoleCount();
        }
        function disableDebug() {
            const conBtn = document.getElementById('consoleBtn');
            if (conBtn) conBtn.remove();
            closeConsoleModal();
        }
    </script>
</body>


</html>